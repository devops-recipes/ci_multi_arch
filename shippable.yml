language: go

matrix:
  include:
    - go: 1.11
      env: GOOS=linux GOARCH=amd64
      nodePool: dynamic__x86_64__Ubuntu_16_04__c4_large
    - go: 1.9
      env: GOOS=linux GOARCH=arm64
      nodePool: default-restricted

build:
  ci:
    - uname -a
    - go version
    - go get ./...
    - |
        if [ "$GOARCH" == "arm4" ]; then
          bash < <(curl -s -S -L https://raw.githubusercontent.com/moovweb/gvm/master/binscripts/gvm-installer)
        fi
    - go build -x -a -o main.out -v ./...
    - ./main.out
